<!DOCTYPE html>
<html>

<head>
    <title>Parse AutoDock Vina Docking Score Text File</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <link rel="stylesheet" type="text/css" href="../../_assets/page.css">
</head>

<body>
    <div class="container">

        <table style="width: 100%;">
            <tr>
                <td>vina_score_parser {emily}</td>
                <td style="text-align: right;">R Documentation</td>
            </tr>
        </table>

        <h2>Parse AutoDock Vina Docking Score Text File</h2>

        <h3>Description</h3>

        <p>This function parses the output from AutoDock Vina, specifically the table
that contains docking scores for each mode, and converts it into a dataframe.</p>

        <h3>Usage</h3>

        <div style="width: 100%; padding-left: 3%; color: black;">
            <pre><code class='language-R' style="color: black; font-weight:normal;"><strong>vina_score_parser</strong>(<i>vina</i>, <i>n</i>);</code></pre>
        </div>

        <h3>Arguments</h3>

        <table>
            
<dt>vina</dt>
<dd><p><p>A character vector containing the content of a Vina score text file,
typically read via \code{\link{readLines}}.</p></p></dd>


<dt>n</dt>
<dd><p><p>The value of the \code{num_modes} command-line argument used in the
Vina docking configuration, indicating how many modes were generated.</p></p></dd>

        </table>


        <h3 style="display: block;">Details</h3>

        <p>This function identifies the table in the Vina output that contains the
docking scores. AutoDock Vina is a widely used open-source program for
molecular docking, which predicts how small molecules bind to a receptor
of known 3D structure. The output includes multiple binding modes (poses)
with their corresponding scores.
The table typically has the following structure:
\preformatted{
mode |   affinity | dist from best mode
| (kcal/mol) | rmsd l.b.| rmsd u.b.


<hr />

+

<hr />

+

<hr />

+

<hr /></p>

<p>1         -6.6      0.000      0.000
2         -6.2      2.396      9.931
3         -6.2      1.562      2.369
...
}
The function extracts this table, processes each line to split on whitespace,
and converts the values to numeric types before creating the final dataframe.
If the function cannot find the table header (a line starting with "mode   |"),
it will stop with an error message indicating that no model result could be parsed.</p>

        <h3 style="display: block">Authors</h3>

        Who wrote it

        <h3>Value</h3>

        <p>A dataframe with the parsed Vina scores. The dataframe has four columns:
\describe{
\item{affinity(kcal/mol)}{The binding affinity in kcal/mol for each mode.}
\item{rmsd l.b.}{The RMSD lower bound for each mode compared to the best mode.}
\item{rmsd u.b.}{The RMSD upper bound for each mode compared to the best mode.}
}
The row names are formatted as "#1", "#2", etc., corresponding to the mode numbers.</p>

        <h3 style="display: block;">Examples</h3>

        <pre><code id="example_r">#\dontrun{

# Read the Vina output file
vina_output <- readLines("vina_output.txt")
# Parse the scores, assuming 10 modes were requested
scores_df <- vina_score_parser(vina_output, n = 10)
# View the resulting dataframe
print(scores_df)
# Access the affinity of the best mode
best_affinity <- scores_df[1, "affinity(kcal/mol)"]
print(paste("Best affinity:", best_affinity, "kcal/mol"))

#}</code></pre>

        <hr />
        <div style="text-align: center;">[Package <em>emily</em> version 0.1.0 <a
                href="../emily.html">Index</a>]
        </div>
    </div>
</body>

<script type="text/javascript" src="../../_assets/R_syntax.js"></script>
<script type="text/javascript" src="../../_assets/highlights.js"></script>
<script type="text/javascript">r_highlights("example_r");</script>

</html>